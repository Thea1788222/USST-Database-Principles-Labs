<!-- 
版权所有 © 2025 [Thea1788222]
本实验报告仅用于个人学习和参考，未经许可不得转载、修改或用于商业用途。
-->


# 实验一 SQL基础查询

## 一、实验目的
1. 熟悉 SQL SERVER：企业管理器、查询分析器；
2. 创建三个关系表：
   - 营业员（工号，姓名，工作年月，联系电话）
   - 商品（商品代码，商品名称，生产商，销售价格，生产日期）
   - 销售（工号，商品代码，销售日期，销售数量）
3. 添加数据（所有本系列实验相关的数据）；
4. 执行查询，参见参考教材，要求使用 `DISTINCT`、`IN`、`LIKE`、`ORDER BY`。

## 二、实验环境
1. 操作系统：Windows 11
2. 数据库软件：SQL Server
3. 编辑工具：SQL Server Management Studio (SSMS)

## 三、实验内容

### 1. 数据库与表的创建 （文件名：`01-create-tables.sql`）
```sql
-- 确保使用 SalesDB 数据库
USE SalesDB;
GO

-- 创建三个表
CREATE TABLE 营业员 (
    工号 CHAR(6) PRIMARY KEY,
    姓名 CHAR(6),
    工作年月 CHAR(8),
    出生年月 CHAR(8),
    联系电话 CHAR(8)
);

CREATE TABLE 商品 (
    商品代码 CHAR(6) PRIMARY KEY,
    商品名称 CHAR(20),
    生产商 CHAR(20),
    销售价格 FLOAT(2),
    生产日期 DATE
);

CREATE TABLE 销售 (
    工号 CHAR(6),
    商品代码 CHAR(6),
    销售日期 DATE,
    销售数量 INT,
    PRIMARY KEY(工号, 商品代码),
    FOREIGN KEY(工号) REFERENCES 营业员(工号),
    FOREIGN KEY(商品代码) REFERENCES 商品(商品代码)
);
```

### 2. 数据插入 （文件名：`02-insert-data.sql`）
```sql
-- 确保使用 SalesDB 数据库
USE SalesDB;
GO

-- 向三个表中插入数据
INSERT INTO 营业员(工号, 姓名, 工作年月, 出生年月, 联系电话) VALUES
    ('MTZ001', '朱元璋', '13680201', '13281021', '62580001'),
    ('MCZ002', '朱棣', '14020701', '13600502', '62580002'),
    ('MXZ003', '朱瞻基', '14250601', '13990316', '62580003'),
    ('MXZ004', '朱见深', '14650101', '14471209', '62580004'),
    ('MSZ005', '朱厚熜', '15220101', '15070916', '62580005');

INSERT INTO 商品(商品代码, 商品名称, 生产商, 销售价格, 生产日期) VALUES
    ('SP001', '洪武通宝铜钱', '户部宝泉局', 88.00, '1368-02-01'),
    ('SP002', '永乐大典复刻', '翰林院书坊', 9999.00, '1403-07-11'),
    ('SP003', '宣德三年铜香炉', '工部铸冶司', 28888.00, '1428-03-28'),
    ('SP004', '成化斗彩鸡缸杯', '御器厂陶作', 168000.00, '1465-09-15'),
    ('SP005', '嘉靖青花云龙罐', '景德镇御窑', 98500.00, '1540-05-20');

INSERT INTO 销售(工号, 商品代码, 销售日期, 销售数量) VALUES
    ('MTZ001', 'SP001', '2023-01-12', 200),
    ('MCZ002', 'SP002', '2023-03-28', 2),
    ('MXZ003', 'SP003', '2023-05-18', 5),
    ('MXZ004', 'SP004', '2023-07-22', 1),
    ('MSZ005', 'SP005', '2023-09-30', 3);
```

### 3. 查询语句 （文件名：`03-query-experiment.sql`）
```sql
-- 确保使用 SalesDB 数据库
USE SalesDB;
GO

-- DISTINCT 查询
SELECT DISTINCT 姓名 FROM 营业员;

-- IN 关键字查询
SELECT * FROM 销售 WHERE 商品代码 IN ('SP002', 'SP004');

-- LIKE 模糊匹配查询
SELECT * FROM 营业员 WHERE 姓名 LIKE('%朱%');

-- ORDER BY 排序查询
SELECT * FROM 商品 ORDER BY 销售价格 ASC;
```

## 四、小结
本次实验主要熟悉了 SQL Server 的基本操作，包括数据库表的创建、数据的插入以及查询操作。通过实验，我熟悉了 SQL Server 的使用流程，并掌握了 `CREATE TABLE`、`INSERT INTO`、`SELECT` 等基本 SQL 语句的应用。

实验过程中，我按照要求完成了表的创建，并成功插入了实验数据。在查询部分，我使用了 `DISTINCT` 进行去重，`IN` 进行条件筛选，`LIKE` 进行模糊匹配，`ORDER BY` 进行排序，验证了这些语句的正确性。